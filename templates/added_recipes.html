<!DOCTYPE html>
<html>

<head>
  <title>Browse recipes</title>
</head>

<body>

<a href="/">
<button>Back to menu</button>
</a>

{% if recipe %}

  <br>
  <br>

  <a href="/added_recipes">
  <button>Back</button>
  </a>

  <h1>{{ recipe.title }}</h1>

  {% if average_rating %}

  <p>
    Average rating: {{ average_rating }} ({{ ratings_amount }} ratings)
  </p>

  {% else %}

    <p>
      No ratings yet.
    </p>

  {% endif %}

  <p>
    From user: <a href="/user/{{ recipe.user_id }}">{{ recipe.username }}</a>
  </p>

  <p>
    <i>{{ recipe.type }}, {{ recipe.diet }}</i>
  </p>

  <p>
  {{ recipe.instructions | show_lines }}
  </p>

  <form action="/add_comment" method="post">

  <p>Write your comment:<br />
    <textarea name="comment" rows="5" cols="70" minlength="10" maxlength="2000" required></textarea>
    <input type="hidden" name="recipe_id" value="{{ recipe.id }}" />
  </p>

  <p>Grade this recipe:</p>

  <p>
    <input type="radio" name="rating" value="0" required/> 0
    <input type="radio" name="rating" value="1" required/> 1
    <input type="radio" name="rating" value="2" required/> 2
    <input type="radio" name="rating" value="3" required/> 3
    <input type="radio" name="rating" value="4" required/> 4
    <input type="radio" name="rating" value="5" required/> 5
  </p>

  <button type="submit">Send</button>

  <br>
  <br>

  <a href="/show_comments/{{ recipe.id }}">Browse comments</a>

  </form>

{% else %}

<form action="/search_recipe" method="get">
  
  <p>
    Search for:
    {% if recipe_query %}

    <input type="text" name="recipe_query" value="{{ recipe_query }}" />

    {% else %}

    <input type="text" name="recipe_query" /> <input type="submit" value="Search" />

    {% endif %}
  </p>

</form>

{% if recipe_query %}

<a href="/added_recipes">
<button>Back</button>
</a>

<h2>Search results:</h2>

{% if results %}

  <ul>

  {% for result in results %}

      <a href="/recipe/{{ result.id }}">
        {{ result.title }}
      </a>
      
      <p>
        From user: <a href="/user/{{ result.user_id }}">{{ result.username }} </a>
      </p>

      <hr>

      <br>

  {% endfor %}

  </ul>

{% else %}

  <p>No results found.</p>
  
{% endif %}

{% elif not recipe_query %}

<h1>Recipe bank</h1>

{% if recipes %}

{% for recipe in recipes %}
  <div>
    <div>
      <a href="/recipe/{{ recipe.id }}">
        {{ recipe.title }}</a>
    </div>
    <br>

    {% if recipe.user_id == session.user_id %}
    <p>
      <a href="/edit_mode/{{ recipe.id }}">Edit</a> |
      <a href="/remove_mode/{{ recipe.id }}">Delete</a>
    </p>

    {% endif %}

    <hr>
  </div>
  
{% endfor %}

{% else %}

  <p>No added recipes yet.</p>

{% endif %}

{% endif %}

{% endif %}

</body>
</html>